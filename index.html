<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TokTik</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;700;800&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0f;
    --surface: #111118;
    --surface2: #1a1a24;
    --border: rgba(255,255,255,0.07);
    --accent: #ff2d6b;
    --accent2: #00e5ff;
    --accent3: #b24bff;
    --text: #f0f0f8;
    --muted: #6b6b80;
    --sidebar-w: 240px;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body { background:var(--bg); color:var(--text); font-family:'DM Sans',sans-serif; height:100vh; overflow:hidden; display:flex; }

  /* â”€â”€â”€ SIDEBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .sidebar {
    width:var(--sidebar-w); height:100vh; background:var(--surface);
    border-right:1px solid var(--border); display:flex; flex-direction:column;
    padding:28px 16px; flex-shrink:0; z-index:10;
  }
  .logo { font-family:'Syne',sans-serif; font-weight:800; font-size:28px; letter-spacing:-1px; margin-bottom:36px; padding-left:8px; cursor:pointer; }
  .logo span:first-child { color:var(--accent); }
  .logo span:last-child  { color:var(--accent2); }

  .nav-item {
    display:flex; align-items:center; gap:12px; padding:11px 12px;
    border-radius:12px; cursor:pointer; font-size:15px; font-weight:500;
    color:var(--muted); transition:all 0.2s; margin-bottom:4px;
    border:none; background:transparent; width:100%; text-align:left;
  }
  .nav-item:hover { background:var(--surface2); color:var(--text); }
  .nav-item.active { background:var(--surface2); color:var(--accent); }
  .nav-icon { font-size:20px; width:24px; text-align:center; }
  .sidebar-spacer { flex:1; }

  .sidebar-user {
    display:flex; align-items:center; gap:10px; padding:12px;
    border-radius:12px; background:var(--surface2); margin-bottom:12px;
  }
  .sidebar-avatar {
    width:34px; height:34px; border-radius:50%;
    background:linear-gradient(135deg,var(--accent),var(--accent3));
    display:flex; align-items:center; justify-content:center; font-size:16px; flex-shrink:0;
  }
  .sidebar-username { font-size:13px; font-weight:600; }
  .sidebar-handle   { font-size:11px; color:var(--muted); }
  .logout-btn { background:transparent; border:none; color:var(--muted); font-size:11px; cursor:pointer; padding:0; text-decoration:underline; transition:color 0.2s; }
  .logout-btn:hover { color:var(--accent); }

  .upload-btn {
    display:flex; align-items:center; justify-content:center; gap:8px; padding:12px;
    border-radius:12px; background:linear-gradient(135deg,var(--accent),var(--accent3));
    color:white; font-family:'Syne',sans-serif; font-weight:700; font-size:14px;
    cursor:pointer; border:none; width:100%; transition:opacity 0.2s,transform 0.15s;
  }
  .upload-btn:hover { opacity:0.9; transform:translateY(-1px); }

  .sign-in-btn {
    display:flex; align-items:center; justify-content:center; gap:8px; padding:12px;
    border-radius:12px; background:transparent; border:1.5px solid var(--accent);
    color:var(--accent); font-family:'Syne',sans-serif; font-weight:700;
    font-size:14px; cursor:pointer; width:100%; transition:background 0.2s;
  }
  .sign-in-btn:hover { background:rgba(255,45,107,0.1); }

  /* â”€â”€â”€ CONTENT AREA (swappable views) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .content { flex:1; height:100vh; display:flex; flex-direction:column; overflow:hidden; }

  /* â”€â”€â”€ TOP BAR (feed only) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .top-bar {
    display:flex; align-items:center; padding:16px 24px; gap:16px;
    border-bottom:1px solid var(--border); flex-shrink:0;
  }
  .tab-btn {
    font-family:'Syne',sans-serif; font-weight:700; font-size:15px;
    padding:6px 14px; border-radius:8px; border:none;
    background:transparent; color:var(--muted); cursor:pointer; transition:color 0.2s;
  }
  .tab-btn.active { color:var(--text); background:var(--surface2); }
  .search-wrap { margin-left:auto; position:relative; }
  .search-input {
    background:var(--surface2); border:1px solid var(--border); border-radius:20px;
    padding:8px 16px 8px 36px; color:var(--text); font-family:'DM Sans',sans-serif;
    font-size:14px; width:200px; outline:none; transition:border-color 0.2s;
  }
  .search-input:focus { border-color:var(--accent2); }
  .search-icon { position:absolute; left:12px; top:50%; transform:translateY(-50%); color:var(--muted); font-size:14px; }

  /* â”€â”€â”€ FEED â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .feed-wrap { flex:1; display:flex; overflow:hidden; }
  .feed-container { flex:1; overflow-y:scroll; scroll-snap-type:y mandatory; scroll-behavior:smooth; }
  .feed-container::-webkit-scrollbar { display:none; }

  .empty-feed { height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:16px; position:relative; overflow:hidden; }
  .empty-glow { position:absolute; width:500px; height:500px; border-radius:50%; background:radial-gradient(circle,rgba(255,45,107,0.08) 0%,rgba(178,75,255,0.05) 50%,transparent 70%); pointer-events:none; animation:pulse 4s ease-in-out infinite; }
  .empty-icon { font-size:72px; position:relative; z-index:1; animation:float 3s ease-in-out infinite; filter:drop-shadow(0 0 30px rgba(255,45,107,0.4)); }
  .empty-title { font-family:'Syne',sans-serif; font-weight:800; font-size:28px; position:relative; z-index:1; }
  .empty-sub { font-size:15px; color:var(--muted); text-align:center; line-height:1.6; position:relative; z-index:1; }
  .empty-action-btn {
    margin-top:8px; padding:14px 32px; border-radius:14px;
    background:linear-gradient(135deg,var(--accent),var(--accent3));
    border:none; color:white; font-family:'Syne',sans-serif; font-weight:700;
    font-size:16px; cursor:pointer; transition:opacity 0.2s,transform 0.15s;
    position:relative; z-index:1; display:flex; align-items:center; gap:8px;
  }
  .empty-action-btn:hover { opacity:0.88; transform:translateY(-2px); }

  @keyframes pulse { 0%,100%{transform:scale(1);opacity:0.7} 50%{transform:scale(1.15);opacity:1} }
  @keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-20px)} }

  /* â”€â”€â”€ RIGHT PANEL (comments) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .right-panel {
    width:320px; height:100%; background:var(--surface);
    border-left:1px solid var(--border); flex-shrink:0; display:flex; flex-direction:column; overflow:hidden;
  }
  .comments-section { flex:1; display:flex; flex-direction:column; overflow:hidden; }
  .comments-header { padding:20px 20px 12px; border-bottom:1px solid var(--border); flex-shrink:0; }
  .panel-title { font-family:'Syne',sans-serif; font-weight:700; font-size:12px; letter-spacing:1px; text-transform:uppercase; color:var(--muted); }
  .comment-list { flex:1; overflow-y:auto; padding:16px 20px; }
  .comment-list::-webkit-scrollbar { width:3px; }
  .comment-list::-webkit-scrollbar-thumb { background:var(--surface2); border-radius:3px; }
  .no-comments { display:flex; flex-direction:column; align-items:center; justify-content:center; height:100%; gap:10px; color:var(--muted); text-align:center; padding:20px; }
  .no-comments-icon { font-size:36px; opacity:0.45; }
  .no-comments-text { font-size:14px; line-height:1.6; }
  .comment { display:flex; gap:10px; margin-bottom:16px; animation:slideIn 0.25s ease; }
  @keyframes slideIn { from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:translateY(0)} }
  .comment-avatar-wrap { width:30px; height:30px; border-radius:50%; background:linear-gradient(135deg,var(--accent),var(--accent3)); display:flex; align-items:center; justify-content:center; font-size:14px; flex-shrink:0; }
  .comment-body { flex:1; }
  .comment-user { font-size:13px; font-weight:600; margin-bottom:2px; }
  .comment-text { font-size:13px; color:rgba(255,255,255,0.8); line-height:1.4; word-break:break-word; }
  .comment-time { font-size:11px; color:var(--muted); margin-top:3px; }
  .comment-input-wrap { padding:14px 20px; border-top:1px solid var(--border); background:var(--surface); flex-shrink:0; }
  .comment-input-row { display:flex; gap:8px; align-items:center; }
  .comment-input { flex:1; background:var(--surface2); border:1px solid var(--border); border-radius:20px; padding:9px 14px; color:var(--text); font-family:'DM Sans',sans-serif; font-size:13px; outline:none; transition:border-color 0.2s; }
  .comment-input:focus { border-color:var(--accent2); }
  .comment-send { width:34px; height:34px; border-radius:50%; background:linear-gradient(135deg,var(--accent),var(--accent3)); border:none; color:white; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:14px; transition:opacity 0.2s; flex-shrink:0; }
  .comment-send:hover { opacity:0.85; }
  .comment-locked { display:flex; align-items:center; gap:10px; padding:10px 14px; border-radius:12px; background:var(--surface2); border:1px solid var(--border); cursor:pointer; transition:border-color 0.2s; }
  .comment-locked:hover { border-color:var(--accent); }
  .comment-locked-text { font-size:13px; color:var(--muted); flex:1; }
  .comment-locked-cta { font-size:13px; color:var(--accent); font-weight:600; white-space:nowrap; }

  /* â”€â”€â”€ PROFILE VIEW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  #profileView {
    display:none; flex:1; overflow-y:auto; flex-direction:column;
  }
  #profileView::-webkit-scrollbar { width:4px; }
  #profileView::-webkit-scrollbar-thumb { background:var(--surface2); border-radius:4px; }

  /* Cover */
  .profile-cover {
    height:200px; position:relative; flex-shrink:0;
    background:linear-gradient(135deg,#1a0020,#0a0a1f,#001a2e);
    overflow:hidden;
  }
  .profile-cover-mesh {
    position:absolute; inset:0;
    background:
      radial-gradient(ellipse 60% 80% at 20% 60%, rgba(255,45,107,0.25), transparent),
      radial-gradient(ellipse 50% 60% at 80% 30%, rgba(178,75,255,0.2), transparent),
      radial-gradient(ellipse 40% 50% at 55% 80%, rgba(0,229,255,0.15), transparent);
  }
  .cover-edit-btn {
    position:absolute; bottom:12px; right:16px;
    background:rgba(0,0,0,0.5); border:1px solid rgba(255,255,255,0.2);
    color:white; border-radius:8px; padding:6px 12px; font-size:12px;
    font-family:'Syne',sans-serif; font-weight:700; cursor:pointer;
    backdrop-filter:blur(8px); transition:background 0.2s;
  }
  .cover-edit-btn:hover { background:rgba(0,0,0,0.7); }

  /* Profile info row */
  .profile-info-row {
    padding:0 28px 24px; position:relative; background:var(--surface);
    border-bottom:1px solid var(--border);
  }
  .profile-avatar-ring {
    width:96px; height:96px; border-radius:50%;
    background:linear-gradient(135deg,var(--accent),var(--accent3));
    display:flex; align-items:center; justify-content:center;
    font-size:44px; flex-shrink:0;
    border:4px solid var(--surface);
    margin-top:-48px; position:relative; z-index:2;
    cursor:pointer; transition:transform 0.2s;
  }
  .profile-avatar-ring:hover { transform:scale(1.05); }
  .avatar-change-hint {
    position:absolute; bottom:0; left:0; right:0; height:32px;
    background:rgba(0,0,0,0.6); border-radius:0 0 50% 50%;
    display:flex; align-items:center; justify-content:center;
    font-size:10px; color:white; opacity:0; transition:opacity 0.2s;
  }
  .profile-avatar-ring:hover .avatar-change-hint { opacity:1; }

  .profile-meta-row {
    display:flex; align-items:flex-start; justify-content:space-between;
    margin-top:12px; gap:16px;
  }
  .profile-name-block {}
  .profile-display-name { font-family:'Syne',sans-serif; font-weight:800; font-size:22px; line-height:1.2; }
  .profile-username { font-size:14px; color:var(--muted); margin-top:2px; }
  .profile-bio-text { font-size:14px; color:rgba(255,255,255,0.75); line-height:1.5; margin-top:8px; max-width:480px; }
  .profile-bio-placeholder { color:var(--muted); font-style:italic; }

  .edit-profile-btn {
    padding:9px 20px; border-radius:10px;
    background:transparent; border:1.5px solid var(--border);
    color:var(--text); font-family:'Syne',sans-serif; font-weight:700;
    font-size:13px; cursor:pointer; white-space:nowrap;
    transition:border-color 0.2s, background 0.2s; flex-shrink:0;
  }
  .edit-profile-btn:hover { border-color:var(--accent2); background:rgba(0,229,255,0.05); }

  /* Stats row */
  .profile-stats-row {
    display:flex; gap:32px; margin-top:16px;
  }
  .p-stat { text-align:center; }
  .p-stat-num { font-family:'Syne',sans-serif; font-weight:800; font-size:20px; }
  .p-stat-label { font-size:12px; color:var(--muted); margin-top:1px; }

  /* Videos grid */
  .profile-content { padding:24px 28px; }
  .profile-section-title {
    font-family:'Syne',sans-serif; font-weight:700; font-size:13px;
    letter-spacing:1px; text-transform:uppercase; color:var(--muted);
    margin-bottom:16px;
  }
  .videos-grid {
    display:grid; grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
    gap:12px;
  }
  .video-card {
    aspect-ratio:9/16; border-radius:12px; overflow:hidden;
    position:relative; cursor:pointer; background:var(--surface2);
    border:1px solid var(--border); transition:transform 0.2s,border-color 0.2s;
    group: true;
  }
  .video-card:hover { transform:scale(1.03); border-color:rgba(255,255,255,0.15); }
  .video-thumb {
    width:100%; height:100%; object-fit:cover;
    display:flex; align-items:center; justify-content:center; font-size:40px;
  }
  .video-overlay {
    position:absolute; inset:0;
    background:linear-gradient(to top,rgba(0,0,0,0.7) 0%,transparent 50%);
    opacity:0; transition:opacity 0.2s;
    display:flex; align-items:flex-end; padding:10px;
  }
  .video-card:hover .video-overlay { opacity:1; }
  .video-play-icon { font-size:24px; }
  .video-like-count { margin-left:auto; font-size:12px; font-weight:700; font-family:'Syne',sans-serif; display:flex; align-items:center; gap:4px; }

  .no-videos {
    grid-column:1/-1; display:flex; flex-direction:column; align-items:center;
    justify-content:center; padding:60px 20px; gap:12px; color:var(--muted); text-align:center;
  }
  .no-videos-icon { font-size:48px; opacity:0.4; }
  .no-videos-text { font-size:15px; }
  .no-videos-btn {
    margin-top:8px; padding:11px 24px; border-radius:12px;
    background:linear-gradient(135deg,var(--accent),var(--accent3));
    border:none; color:white; font-family:'Syne',sans-serif; font-weight:700;
    font-size:14px; cursor:pointer; transition:opacity 0.2s;
  }
  .no-videos-btn:hover { opacity:0.88; }

  /* Edit profile form (inline) */
  .edit-form {
    display:none; padding:20px 28px 24px;
    border-bottom:1px solid var(--border); background:var(--surface2);
    animation:slideIn 0.2s ease;
  }
  .edit-form.open { display:block; }
  .edit-form-title { font-family:'Syne',sans-serif; font-weight:800; font-size:16px; margin-bottom:16px; }
  .edit-field { margin-bottom:14px; }
  .edit-label { font-size:11px; font-weight:600; color:var(--muted); letter-spacing:0.6px; text-transform:uppercase; margin-bottom:6px; display:block; }
  .edit-input {
    width:100%; background:var(--surface); border:1px solid var(--border);
    border-radius:10px; padding:10px 14px; color:var(--text);
    font-family:'DM Sans',sans-serif; font-size:14px; outline:none;
    transition:border-color 0.2s;
  }
  .edit-input:focus { border-color:var(--accent2); }
  .edit-textarea {
    width:100%; background:var(--surface); border:1px solid var(--border);
    border-radius:10px; padding:10px 14px; color:var(--text);
    font-family:'DM Sans',sans-serif; font-size:14px; outline:none;
    resize:vertical; min-height:80px; transition:border-color 0.2s;
  }
  .edit-textarea:focus { border-color:var(--accent2); }

  /* Emoji picker */
  .emoji-grid { display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; }
  .emoji-opt {
    width:40px; height:40px; border-radius:10px; font-size:22px;
    display:flex; align-items:center; justify-content:center;
    background:var(--surface); border:1.5px solid var(--border);
    cursor:pointer; transition:all 0.15s;
  }
  .emoji-opt:hover  { border-color:var(--accent2); transform:scale(1.1); }
  .emoji-opt.selected { border-color:var(--accent); background:rgba(255,45,107,0.15); }

  .edit-form-footer { display:flex; gap:10px; margin-top:16px; }
  .btn-save {
    flex:1; padding:11px; border-radius:10px;
    background:linear-gradient(135deg,var(--accent),var(--accent3));
    border:none; color:white; font-family:'Syne',sans-serif; font-weight:700; cursor:pointer; transition:opacity 0.2s;
  }
  .btn-save:hover { opacity:0.88; }
  .btn-discard {
    flex:1; padding:11px; border-radius:10px;
    background:var(--surface); border:1px solid var(--border);
    color:var(--text); font-family:'Syne',sans-serif; font-weight:700; cursor:pointer; transition:background 0.2s;
  }
  .btn-discard:hover { background:rgba(255,255,255,0.05); }

  /* â”€â”€â”€ MODALS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  .modal-overlay {
    position:fixed; inset:0; background:rgba(0,0,0,0.8); backdrop-filter:blur(8px);
    z-index:100; display:none; align-items:center; justify-content:center;
  }
  .modal-overlay.open { display:flex; }
  .modal {
    background:var(--surface); border:1px solid var(--border);
    border-radius:20px; padding:36px; width:420px; max-width:95vw;
    position:relative; animation:modalIn 0.28s cubic-bezier(0.34,1.56,0.64,1);
  }
  @keyframes modalIn { from{opacity:0;transform:scale(0.92) translateY(16px)} to{opacity:1;transform:scale(1) translateY(0)} }
  .modal-close { position:absolute; top:16px; right:18px; background:transparent; border:none; color:var(--muted); font-size:20px; cursor:pointer; line-height:1; transition:color 0.2s; }
  .modal-close:hover { color:var(--text); }
  .modal-logo { font-family:'Syne',sans-serif; font-weight:800; font-size:24px; text-align:center; margin-bottom:4px; }
  .modal-logo span:first-child { color:var(--accent); }
  .modal-logo span:last-child  { color:var(--accent2); }
  .modal-subtitle { text-align:center; color:var(--muted); font-size:14px; margin-bottom:26px; }
  .auth-tabs { display:flex; background:var(--surface2); border-radius:10px; padding:4px; gap:4px; margin-bottom:22px; }
  .auth-tab { flex:1; padding:8px; border-radius:8px; border:none; background:transparent; color:var(--muted); font-family:'Syne',sans-serif; font-weight:700; font-size:14px; cursor:pointer; transition:all 0.2s; }
  .auth-tab.active { background:var(--surface); color:var(--text); }
  .field-wrap { margin-bottom:14px; }
  .field-label { font-size:11px; font-weight:600; color:var(--muted); margin-bottom:6px; letter-spacing:0.6px; text-transform:uppercase; display:block; }
  .auth-input { width:100%; background:var(--surface2); border:1px solid var(--border); border-radius:10px; padding:11px 14px; color:var(--text); font-family:'DM Sans',sans-serif; font-size:14px; outline:none; transition:border-color 0.2s; }
  .auth-input:focus { border-color:var(--accent2); }
  .auth-error { background:rgba(255,45,107,0.1); border:1px solid rgba(255,45,107,0.3); border-radius:8px; padding:10px 14px; font-size:13px; color:var(--accent); margin-bottom:14px; display:none; }
  .auth-error.show { display:block; }
  .auth-submit { width:100%; padding:13px; background:linear-gradient(135deg,var(--accent),var(--accent3)); border:none; border-radius:12px; color:white; font-family:'Syne',sans-serif; font-weight:700; font-size:15px; cursor:pointer; transition:opacity 0.2s; margin-top:4px; }
  .auth-submit:hover { opacity:0.88; }

  /* Upload modal */
  .upload-modal-title { font-family:'Syne',sans-serif; font-weight:800; font-size:20px; margin-bottom:20px; }
  .upload-zone { border:2px dashed var(--border); border-radius:16px; padding:36px 20px; text-align:center; cursor:pointer; transition:all 0.2s; margin-bottom:18px; }
  .upload-zone:hover { border-color:var(--accent); background:rgba(255,45,107,0.05); }
  .upload-icon-big { font-size:36px; margin-bottom:10px; }
  .upload-hint { font-size:13px; color:var(--muted); margin-top:6px; }
  .upload-hint strong { color:var(--accent); }
  .modal-input { width:100%; background:var(--surface2); border:1px solid var(--border); border-radius:10px; padding:10px 14px; color:var(--text); font-family:'DM Sans',sans-serif; font-size:14px; outline:none; margin-bottom:10px; transition:border-color 0.2s; }
  .modal-input:focus { border-color:var(--accent2); }
  .modal-footer { display:flex; gap:10px; margin-top:10px; }
  .btn-cancel { flex:1; padding:12px; border-radius:10px; background:var(--surface2); border:1px solid var(--border); color:var(--text); font-family:'Syne',sans-serif; font-weight:700; cursor:pointer; transition:background 0.2s; }
  .btn-cancel:hover { background:rgba(255,255,255,0.06); }
  .btn-post { flex:1; padding:12px; border-radius:10px; background:linear-gradient(135deg,var(--accent),var(--accent3)); border:none; color:white; font-family:'Syne',sans-serif; font-weight:700; cursor:pointer; transition:opacity 0.2s; }
  .btn-post:hover { opacity:0.88; }

  /* Toast */
  .toast {
    position:fixed; bottom:32px; left:50%; transform:translateX(-50%);
    background:rgba(10,10,15,0.92); border:1px solid var(--border);
    color:var(--text); padding:10px 22px; border-radius:20px;
    font-family:'Syne',sans-serif; font-weight:600; font-size:14px;
    z-index:300; backdrop-filter:blur(12px); pointer-events:none; white-space:nowrap;
    animation:toastIn 0.3s ease forwards;
  }
  @keyframes toastIn { from{opacity:0;transform:translateX(-50%) translateY(10px)} to{opacity:1;transform:translateX(-50%) translateY(0)} }

  /* Responsive */
  @media (max-width:1100px) { .right-panel { display:none; } }
  @media (max-width:700px) {
    .sidebar { width:64px; }
    .logo span, .nav-text, .sidebar-username, .sidebar-handle, .logout-btn { display:none; }
    .nav-item { justify-content:center; }
    .upload-btn, .sign-in-btn { padding:12px; justify-content:center; }
    .upload-btn span:last-child, .sign-in-btn span:last-child { display:none; }
  }
</style>
</head>
<body>

<!-- â•â•â• SIDEBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<aside class="sidebar">
  <div class="logo" onclick="showView('feed')"><span>Tok</span><span>Tik</span></div>
  <nav>
    <button class="nav-item active" id="navHome" onclick="showView('feed')">
      <span class="nav-icon">ğŸ </span><span class="nav-text">For You</span>
    </button>
    <button class="nav-item" id="navExplore" onclick="showView('feed')">
      <span class="nav-icon">ğŸ”</span><span class="nav-text">Explore</span>
    </button>
    <button class="nav-item" id="navProfile" onclick="handleProfileNav()">
      <span class="nav-icon">ğŸ‘¤</span><span class="nav-text">Profile</span>
    </button>
  </nav>
  <div class="sidebar-spacer"></div>

  <!-- Logged IN -->
  <div id="sidebarLoggedIn" style="display:none">
    <div class="sidebar-user">
      <div class="sidebar-avatar" id="sidebarEmoji">ğŸ˜€</div>
      <div>
        <div class="sidebar-username" id="sidebarName">User</div>
        <div class="sidebar-handle"   id="sidebarHandle">@handle</div>
        <button class="logout-btn" onclick="logout()">Log out</button>
      </div>
    </div>
    <button class="upload-btn" onclick="openUpload()">
      <span>ï¼‹</span><span>Upload</span>
    </button>
  </div>

  <!-- Logged OUT -->
  <div id="sidebarLoggedOut">
    <button class="sign-in-btn" onclick="openAuth()">
      <span>ğŸ‘¤</span><span>Sign In</span>
    </button>
  </div>
</aside>

<!-- â•â•â• CONTENT AREA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="content">

  <!-- â”€â”€ FEED VIEW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="feedView" style="display:flex;flex-direction:column;flex:1;overflow:hidden;">
    <div class="top-bar">
      <button class="tab-btn active" onclick="switchFeedTab(this)">For You</button>
      <button class="tab-btn" onclick="switchFeedTab(this)">Following</button>
      <button class="tab-btn" onclick="switchFeedTab(this)">Trending</button>
      <div class="search-wrap">
        <span class="search-icon">ğŸ”</span>
        <input class="search-input" type="text" placeholder="Search TokTikâ€¦">
      </div>
    </div>
    <div class="feed-wrap">
      <div class="feed-container" id="feedContainer">
        <div class="empty-feed">
          <div class="empty-glow"></div>
          <div class="empty-icon">ğŸ¬</div>
          <h2 class="empty-title">No videos yet</h2>
          <p class="empty-sub" id="emptySubText">Sign in and be the first to post on TokTik.</p>
          <button class="empty-action-btn" onclick="handleEmptyAction()">
            <span id="emptyBtnLabel">ï¼‹ Get Started</span>
          </button>
        </div>
      </div>
      <!-- Comments right panel (only visible in feed) -->
      <aside class="right-panel">
        <div class="comments-section">
          <div class="comments-header"><div class="panel-title">Comments</div></div>
          <div class="comment-list" id="commentList"></div>
          <div class="comment-input-wrap">
            <div class="comment-input-row" id="commentInputRow" style="display:none">
              <input class="comment-input" id="commentInput" type="text" placeholder="Add a commentâ€¦" maxlength="280" onkeydown="if(event.key==='Enter')postComment()">
              <button class="comment-send" onclick="postComment()">â¤</button>
            </div>
            <div class="comment-locked" id="commentLocked" onclick="openAuth()">
              <span>ğŸ”’</span>
              <span class="comment-locked-text">Want to comment?</span>
              <span class="comment-locked-cta">Sign in â†’</span>
            </div>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <!-- â”€â”€ PROFILE VIEW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="profileView">

    <!-- Cover -->
    <div class="profile-cover">
      <div class="profile-cover-mesh"></div>
      <button class="cover-edit-btn" id="coverEditBtn" onclick="openEditForm()" style="display:none">âœï¸ Edit Profile</button>
    </div>

    <!-- Info row -->
    <div class="profile-info-row">
      <div class="profile-avatar-ring" id="profileAvatarRing" onclick="openEditForm()">
        <span id="profileAvatarEmoji">ğŸ¦‹</span>
        <div class="avatar-change-hint">change</div>
      </div>
      <div class="profile-meta-row">
        <div class="profile-name-block">
          <div class="profile-display-name" id="profileDisplayName">â€”</div>
          <div class="profile-username"     id="profileUsernameEl">@â€”</div>
          <div class="profile-bio-text"     id="profileBioEl"><span class="profile-bio-placeholder">No bio yet.</span></div>
        </div>
        <button class="edit-profile-btn" id="editProfileBtn" onclick="openEditForm()" style="display:none">Edit Profile</button>
      </div>

      <!-- Stats -->
      <div class="profile-stats-row">
        <div class="p-stat">
          <div class="p-stat-num" id="statVideos">0</div>
          <div class="p-stat-label">Videos</div>
        </div>
        <div class="p-stat">
          <div class="p-stat-num" id="statFollowers">0</div>
          <div class="p-stat-label">Followers</div>
        </div>
        <div class="p-stat">
          <div class="p-stat-num" id="statFollowing">0</div>
          <div class="p-stat-label">Following</div>
        </div>
        <div class="p-stat">
          <div class="p-stat-num" id="statLikes">0</div>
          <div class="p-stat-label">Likes</div>
        </div>
      </div>
    </div>

    <!-- Edit form (inline, hidden by default) -->
    <div class="edit-form" id="editForm">
      <div class="edit-form-title">Edit Profile</div>

      <div class="edit-field">
        <label class="edit-label">Display Name</label>
        <input class="edit-input" id="editName" type="text" maxlength="40" placeholder="Your display name">
      </div>
      <div class="edit-field">
        <label class="edit-label">Bio</label>
        <textarea class="edit-textarea" id="editBio" maxlength="160" placeholder="Tell the world about yourselfâ€¦ (160 chars)"></textarea>
      </div>
      <div class="edit-field">
        <label class="edit-label">Avatar</label>
        <div class="emoji-grid" id="emojiGrid"></div>
      </div>

      <div class="edit-form-footer">
        <button class="btn-discard" onclick="closeEditForm()">Discard</button>
        <button class="btn-save"    onclick="saveProfile()">Save Changes</button>
      </div>
    </div>

    <!-- Videos grid -->
    <div class="profile-content">
      <div class="profile-section-title">Videos</div>
      <div class="videos-grid" id="videosGrid"></div>
    </div>

  </div><!-- /profileView -->

</div><!-- /content -->

<!-- â•â•â• AUTH MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="authModal" onclick="overlayClose(event,'authModal')">
  <div class="modal" onclick="event.stopPropagation()">
    <button class="modal-close" onclick="closeModal('authModal')">âœ•</button>
    <div class="modal-logo"><span>Tok</span><span>Tik</span></div>
    <div class="modal-subtitle">Join the community</div>
    <div class="auth-tabs">
      <button class="auth-tab active" id="tabLogin"  onclick="switchAuthTab('login')">Log In</button>
      <button class="auth-tab"        id="tabSignup" onclick="switchAuthTab('signup')">Sign Up</button>
    </div>
    <div class="auth-error" id="authError"></div>

    <!-- Login -->
    <div id="loginForm">
      <div class="field-wrap">
        <label class="field-label">Username</label>
        <input class="auth-input" id="loginUsername" type="text" placeholder="your_username" autocomplete="username">
      </div>
      <div class="field-wrap">
        <label class="field-label">Password</label>
        <input class="auth-input" id="loginPassword" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password" onkeydown="if(event.key==='Enter')submitLogin()">
      </div>
      <button class="auth-submit" onclick="submitLogin()">Log In</button>
    </div>

    <!-- Signup -->
    <div id="signupForm" style="display:none">
      <div class="field-wrap">
        <label class="field-label">Display Name</label>
        <input class="auth-input" id="signupName" type="text" placeholder="Your Name" autocomplete="name">
      </div>
      <div class="field-wrap">
        <label class="field-label">Username</label>
        <input class="auth-input" id="signupUsername" type="text" placeholder="your_username" autocomplete="username">
      </div>
      <div class="field-wrap">
        <label class="field-label">Password</label>
        <input class="auth-input" id="signupPassword" type="password" placeholder="Min. 6 characters" autocomplete="new-password">
      </div>
      <div class="field-wrap">
        <label class="field-label">Confirm Password</label>
        <input class="auth-input" id="signupConfirm" type="password" placeholder="Repeat password" autocomplete="new-password" onkeydown="if(event.key==='Enter')submitSignup()">
      </div>
      <button class="auth-submit" onclick="submitSignup()">Create Account</button>
    </div>
  </div>
</div>

<!-- â•â•â• UPLOAD MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="uploadModal" onclick="overlayClose(event,'uploadModal')">
  <div class="modal" onclick="event.stopPropagation()">
    <button class="modal-close" onclick="closeModal('uploadModal')">âœ•</button>
    <div class="upload-modal-title">Upload to TokTik ğŸ¬</div>
    <div class="upload-zone" onclick="toast('ğŸ“ File picker coming soon!')">
      <div class="upload-icon-big">ğŸ“¤</div>
      <div>Drop your video here or <strong>browse files</strong></div>
      <div class="upload-hint">MP4, MOV, AVI Â· up to 500MB</div>
    </div>
    <input class="modal-input" type="text" placeholder="Write a captionâ€¦ #hashtags welcome">
    <input class="modal-input" type="text" placeholder="Add music or sound">
    <div style="display:flex;gap:16px;margin-bottom:4px">
      <label style="display:flex;align-items:center;gap:8px;font-size:14px;color:var(--muted);cursor:pointer">
        <input type="checkbox" checked style="accent-color:var(--accent)"> Allow comments
      </label>
      <label style="display:flex;align-items:center;gap:8px;font-size:14px;color:var(--muted);cursor:pointer">
        <input type="checkbox" style="accent-color:var(--accent)"> Private
      </label>
    </div>
    <div class="modal-footer">
      <button class="btn-cancel" onclick="closeModal('uploadModal')">Cancel</button>
      <button class="btn-post"   onclick="toast('ğŸ‰ Video posted!');closeModal('uploadModal')">Post Video</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCRIPT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
// â”€â”€â”€ Store â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const STORE_KEY = 'toktik_v2';
function getStore() {
  try { return JSON.parse(sessionStorage.getItem(STORE_KEY)) || defaultStore(); }
  catch { return defaultStore(); }
}
function defaultStore() { return { users:[], comments:[], session:null }; }
function putStore(s) { sessionStorage.setItem(STORE_KEY, JSON.stringify(s)); }
function me() { return getStore().session; }
function isLoggedIn() { return !!me(); }

// â”€â”€â”€ Available avatars â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const AVATARS = ['ğŸ¦Š','ğŸº','ğŸŒ¸','ğŸ®','ğŸ³','ğŸŒŒ','ğŸ¨','ğŸ„','ğŸ¤–','ğŸ¦','ğŸ¸','ğŸ¦‹','ğŸ™','ğŸ¦„','ğŸ¯','ğŸ”¥','âš¡','ğŸ­','ğŸ¦…','ğŸ¬','ğŸŒŠ','ğŸ¸','ğŸ”ï¸','ğŸŒ»','ğŸ¦©'];

// â”€â”€â”€ View switching â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showView(view) {
  const feedEl    = document.getElementById('feedView');
  const profileEl = document.getElementById('profileView');
  const navHome   = document.getElementById('navHome');
  const navExplore= document.getElementById('navExplore');
  const navProfile= document.getElementById('navProfile');

  [navHome, navExplore, navProfile].forEach(b => b.classList.remove('active'));

  if (view === 'feed') {
    feedEl.style.display    = 'flex';
    profileEl.style.display = 'none';
    navHome.classList.add('active');
  } else if (view === 'profile') {
    feedEl.style.display    = 'none';
    profileEl.style.display = 'flex';
    navProfile.classList.add('active');
    renderProfile();
  }
}

// â”€â”€â”€ Profile nav â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function handleProfileNav() {
  if (!isLoggedIn()) { openAuth(); return; }
  showView('profile');
}

// â”€â”€â”€ Render profile â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderProfile() {
  const user = me();
  if (!user) return;

  // Update cover edit button visibility
  document.getElementById('coverEditBtn').style.display   = 'block';
  document.getElementById('editProfileBtn').style.display = 'block';

  // Get full user data
  const s    = getStore();
  const full = s.users.find(u => u.username === user.username) || user;

  document.getElementById('profileAvatarEmoji').textContent = full.emoji || user.emoji;
  document.getElementById('profileDisplayName').textContent = full.name  || user.name;
  document.getElementById('profileUsernameEl').textContent  = '@' + user.username;

  const bioEl = document.getElementById('profileBioEl');
  if (full.bio && full.bio.trim()) {
    bioEl.innerHTML = esc(full.bio);
  } else {
    bioEl.innerHTML = '<span class="profile-bio-placeholder">No bio yet. Click Edit Profile to add one.</span>';
  }

  // Stats (all 0 for now â€” real backend would populate these)
  document.getElementById('statVideos').textContent   = full.videoCount   || 0;
  document.getElementById('statFollowers').textContent= full.followers     || 0;
  document.getElementById('statFollowing').textContent= full.following     || 0;
  document.getElementById('statLikes').textContent    = full.totalLikes    || 0;

  renderVideosGrid(full);
}

// â”€â”€â”€ Videos grid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderVideosGrid(user) {
  const grid = document.getElementById('videosGrid');
  const videos = user.videos || [];

  if (videos.length === 0) {
    grid.innerHTML = `
      <div class="no-videos">
        <div class="no-videos-icon">ğŸ¬</div>
        <div class="no-videos-text">No videos yet</div>
        <button class="no-videos-btn" onclick="openUpload()">ï¼‹ Upload your first video</button>
      </div>`;
    return;
  }

  // Render video cards (if videos existed)
  grid.innerHTML = videos.map((vid, i) => `
    <div class="video-card" onclick="toast('â–¶ï¸ Playing ${esc(vid.caption || 'video')}')">
      <div class="video-thumb" style="background:${vid.color || 'var(--surface2)'}">
        ${vid.emoji || 'ğŸ¬'}
      </div>
      <div class="video-overlay">
        <span class="video-play-icon">â–¶</span>
        <span class="video-like-count">â¤ï¸ ${vid.likes || 0}</span>
      </div>
    </div>`).join('');
}

// â”€â”€â”€ Edit form â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openEditForm() {
  const user = me();
  if (!user) return;
  const s    = getStore();
  const full = s.users.find(u => u.username === user.username) || user;

  // Populate fields
  document.getElementById('editName').value = full.name || '';
  document.getElementById('editBio').value  = full.bio  || '';

  // Build emoji grid
  const grid = document.getElementById('emojiGrid');
  grid.innerHTML = AVATARS.map(e => `
    <div class="emoji-opt ${e === (full.emoji || user.emoji) ? 'selected' : ''}"
         onclick="selectEmoji(this,'${e}')">${e}</div>`).join('');

  document.getElementById('editForm').classList.add('open');
  document.getElementById('profileView').scrollTop = document.getElementById('profileView').scrollHeight;
  setTimeout(() => document.getElementById('editForm').scrollIntoView({ behavior:'smooth', block:'nearest' }), 50);
}

function closeEditForm() {
  document.getElementById('editForm').classList.remove('open');
}

function selectEmoji(el, emoji) {
  document.querySelectorAll('.emoji-opt').forEach(e => e.classList.remove('selected'));
  el.classList.add('selected');
  el.dataset.value = emoji;
}

function getSelectedEmoji() {
  const sel = document.querySelector('.emoji-opt.selected');
  return sel ? sel.textContent.trim() : null;
}

function saveProfile() {
  const name  = document.getElementById('editName').value.trim();
  const bio   = document.getElementById('editBio').value.trim();
  const emoji = getSelectedEmoji();

  if (!name) { toast('âš ï¸ Display name cannot be empty.'); return; }

  const s    = getStore();
  const user = me();
  const idx  = s.users.findIndex(u => u.username === user.username);
  if (idx === -1) return;

  s.users[idx].name  = name;
  s.users[idx].bio   = bio;
  if (emoji) s.users[idx].emoji = emoji;

  // Update session too
  s.session.name  = name;
  if (emoji) s.session.emoji = emoji;

  putStore(s);
  closeEditForm();
  refreshUI();
  renderProfile();
  toast('âœ… Profile updated!');
}

// â”€â”€â”€ Auth & UI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function refreshUI() {
  const user = me();
  document.getElementById('sidebarLoggedIn').style.display  = user ? 'block' : 'none';
  document.getElementById('sidebarLoggedOut').style.display = user ? 'none'  : 'block';

  if (user) {
    document.getElementById('sidebarEmoji').textContent  = user.emoji;
    document.getElementById('sidebarName').textContent   = user.name;
    document.getElementById('sidebarHandle').textContent = '@' + user.username;
  }

  document.getElementById('commentInputRow').style.display = user ? 'flex'  : 'none';
  document.getElementById('commentLocked').style.display   = user ? 'none'  : 'flex';
  document.getElementById('emptySubText').textContent  = user ? 'Be the first to post on TokTik.' : 'Sign in and be the first to post on TokTik.';
  document.getElementById('emptyBtnLabel').textContent = user ? 'ï¼‹ Upload a Video' : 'ï¼‹ Get Started';

  renderComments();
}

function submitSignup() {
  const name  = v('signupName').trim();
  const uname = v('signupUsername').trim().toLowerCase().replace(/\s+/g,'');
  const pw    = v('signupPassword');
  const pwc   = v('signupConfirm');

  if (!name)                         return authErr('Please enter your display name.');
  if (uname.length < 3)             return authErr('Username must be at least 3 characters.');
  if (!/^[a-z0-9_.]+$/.test(uname)) return authErr('Username: letters, numbers, _ and . only.');
  if (pw.length < 6)                 return authErr('Password must be at least 6 characters.');
  if (pw !== pwc)                    return authErr("Passwords don't match.");

  const s = getStore();
  if (s.users.find(u => u.username === uname)) return authErr('That username is already taken.');

  const emoji = AVATARS[Math.floor(Math.random() * AVATARS.length)];
  s.users.push({ name, username: uname, pw, emoji, bio:'', videos:[], videoCount:0, followers:0, following:0, totalLikes:0 });
  s.session = { name, username: uname, emoji };
  putStore(s);

  closeModal('authModal');
  refreshUI();
  toast(`ğŸ‘‹ Welcome to TokTik, ${name}!`);
}

function submitLogin() {
  const uname = v('loginUsername').trim().toLowerCase();
  const pw    = v('loginPassword');
  if (!uname) return authErr('Please enter your username.');
  if (!pw)    return authErr('Please enter your password.');

  const s    = getStore();
  const user = s.users.find(u => u.username === uname && u.pw === pw);
  if (!user)  return authErr('Incorrect username or password.');

  s.session = { name: user.name, username: user.username, emoji: user.emoji };
  putStore(s);
  closeModal('authModal');
  refreshUI();
  toast(`ğŸ‘‹ Welcome back, ${user.name}!`);
}

function logout() {
  const s = getStore(); s.session = null; putStore(s);
  showView('feed');
  refreshUI();
  toast('See you soon! ğŸ‘‹');
}

// â”€â”€â”€ Comments â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderComments() {
  const { comments } = getStore();
  const list = document.getElementById('commentList');
  if (!comments || comments.length === 0) {
    list.innerHTML = `<div class="no-comments"><div class="no-comments-icon">ğŸ’¬</div><div class="no-comments-text">No comments yet.<br>Be the first to say something!</div></div>`;
    return;
  }
  list.innerHTML = comments.slice().reverse().map(c => `
    <div class="comment">
      <div class="comment-avatar-wrap">${c.emoji}</div>
      <div class="comment-body">
        <div class="comment-user">@${esc(c.username)}</div>
        <div class="comment-text">${esc(c.text)}</div>
        <div class="comment-time">${esc(c.time)}</div>
      </div>
    </div>`).join('');
}

function postComment() {
  if (!isLoggedIn()) { openAuth(); return; }
  const input = document.getElementById('commentInput');
  const text  = input.value.trim();
  if (!text) return;
  const user = me();
  const s    = getStore();
  s.comments.push({ username: user.username, emoji: user.emoji, text, time: 'just now' });
  putStore(s);
  input.value = '';
  renderComments();
  document.getElementById('commentList').scrollTop = 0;
}

// â”€â”€â”€ Auth modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openAuth(tab) {
  switchAuthTab(tab || 'login');
  clearAuth();
  document.getElementById('authModal').classList.add('open');
}
function switchAuthTab(tab) {
  document.getElementById('loginForm').style.display  = tab === 'login'  ? 'block' : 'none';
  document.getElementById('signupForm').style.display = tab === 'signup' ? 'block' : 'none';
  document.getElementById('tabLogin').classList.toggle('active',  tab === 'login');
  document.getElementById('tabSignup').classList.toggle('active', tab === 'signup');
  hideAuthErr();
}
function authErr(msg) { const el = document.getElementById('authError'); el.textContent = msg; el.classList.add('show'); }
function hideAuthErr() { document.getElementById('authError').classList.remove('show'); }
function clearAuth() {
  ['loginUsername','loginPassword','signupName','signupUsername','signupPassword','signupConfirm']
    .forEach(id => { const el = document.getElementById(id); if(el) el.value=''; });
  hideAuthErr();
}

// â”€â”€â”€ Upload â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openUpload() {
  if (!isLoggedIn()) { openAuth(); return; }
  document.getElementById('uploadModal').classList.add('open');
}

// â”€â”€â”€ Empty feed CTA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function handleEmptyAction() {
  if (isLoggedIn()) openUpload();
  else openAuth('signup');
}

// â”€â”€â”€ Modal helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function closeModal(id) { document.getElementById(id).classList.remove('open'); }
function overlayClose(e, id) { if(e.target === document.getElementById(id)) closeModal(id); }

// â”€â”€â”€ Toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toast(msg) {
  const el = document.createElement('div');
  el.className = 'toast'; el.textContent = msg;
  document.body.appendChild(el);
  setTimeout(() => el.remove(), 2800);
}

// â”€â”€â”€ Nav â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function switchFeedTab(el) {
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  el.classList.add('active');
}

// â”€â”€â”€ Keyboard nav â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.addEventListener('keydown', e => {
  if (['INPUT','TEXTAREA'].includes(document.activeElement.tagName)) return;
  const feed = document.getElementById('feedContainer');
  const h = feed.clientHeight;
  if      (e.key === 'ArrowDown' || e.key === 'j') feed.scrollBy({top:  h, behavior:'smooth'});
  else if (e.key === 'ArrowUp'   || e.key === 'k') feed.scrollBy({top: -h, behavior:'smooth'});
});

// â”€â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function v(id) { return document.getElementById(id).value || ''; }
function esc(s) { return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

// â”€â”€â”€ Boot â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
refreshUI();
showView('feed');
</script>
</body>
</html>
